{% extends "base.html" %}

{% block title %}{{ project_name }} - {% if mode == 'memorize' %}èƒŒé¢˜æ¨¡å¼{% elif mode == 'sequential' %}é¡ºåºç»ƒä¹ {% else %}éšæœºç»ƒä¹ {% endif %}{% endblock %}

{% block extra_head %}
<script>
    // ä¼ é€’æ•°æ®åˆ° JavaScript
    window.practiceData = {
        projectName: {{ project_name | tojson }},
        mode: {{ mode | tojson }},
        questions: {{ questions | tojson }},
        userAnswers: {{ user_answers | tojson }},
        total: {{ total }}
    };
</script>
{% endblock %}

{% block content %}
<div class="practice-page">
    <!-- é¡¶éƒ¨å¯¼èˆª -->
    <header class="practice-header">
        <a href="{{ url_for('projects') }}" class="btn btn-icon" title="è¿”å›">â†</a>
        <div class="header-info">
            <h1 class="header-title">
                {% if mode == 'memorize' %}ğŸ“– èƒŒé¢˜æ¨¡å¼
                {% elif mode == 'sequential' %}ğŸ“ é¡ºåºç»ƒä¹ 
                {% else %}ğŸ² éšæœºç»ƒä¹ {% endif %}
            </h1>
            <span class="header-subtitle">{{ project_name }}</span>
        </div>
        <button id="toggleCard" class="btn btn-icon" title="ç­”é¢˜å¡">ğŸ“‹</button>
    </header>
    
    <!-- ä¸»è¦å†…å®¹åŒºåŸŸ -->
    <div class="practice-main">
        <!-- é¢˜ç›®åŒºåŸŸ -->
        <div class="question-area">
            <div class="question-header">
                <span class="question-number">ç¬¬ <span id="currentNum">1</span>/<span id="totalNum">{{ total }}</span> é¢˜</span>
                <span id="questionType" class="question-type"></span>
            </div>
            
            <div class="question-content">
                <div id="questionText" class="question-text"></div>
                
                <div id="optionsContainer" class="options-container"></div>
            </div>
            
            <!-- ç­”æ¡ˆåé¦ˆåŒº -->
            <div id="feedbackArea" class="feedback-area hidden">
                <div id="feedbackContent"></div>
            </div>
            
            <!-- æ“ä½œæŒ‰é’® -->
            <div class="question-actions">
                <button id="prevBtn" class="btn btn-secondary">ä¸Šä¸€é¢˜</button>
                <button id="submitBtn" class="btn btn-primary">æäº¤ç­”æ¡ˆ</button>
                <button id="nextBtn" class="btn btn-secondary">ä¸‹ä¸€é¢˜</button>
            </div>
            
            <!-- é‡ç½®è¿›åº¦æŒ‰é’® -->
            <div class="reset-area">
                <button id="resetBtn" class="btn btn-danger btn-small">é‡ç½®æœ¬é¡¹ç›®è¿›åº¦</button>
            </div>
        </div>
        
        <!-- ç­”é¢˜å¡ä¾§è¾¹æ  -->
        <aside id="answerCard" class="answer-card">
            <div class="card-header">
                <h3>ç­”é¢˜å¡</h3>
                <button id="closeCard" class="btn btn-icon btn-small">Ã—</button>
            </div>
            <div class="card-stats">
                <span>æ€»è®¡: <strong id="statTotal">{{ total }}</strong></span>
                <span>å·²ç­”: <strong id="statAnswered">0</strong></span>
                <span>æ­£ç¡®: <strong id="statCorrect">0</strong></span>
            </div>
            <div class="card-legend">
                <span class="legend-item"><span class="legend-color unanswered"></span>æœªç­”</span>
                <span class="legend-item"><span class="legend-color correct"></span>æ­£ç¡®</span>
                <span class="legend-item"><span class="legend-color wrong"></span>é”™è¯¯</span>
                <span class="legend-item"><span class="legend-color current"></span>å½“å‰</span>
            </div>
            <div id="cardGrid" class="card-grid"></div>
        </aside>
    </div>
</div>

<!-- ç­”é¢˜å¡é®ç½©å±‚ï¼ˆç§»åŠ¨ç«¯ï¼‰ -->
<div id="cardOverlay" class="card-overlay"></div>
{% endblock %}

{% block extra_scripts %}
<script src="{{ url_for('static', filename='practice.js') }}"></script>
{% endblock %}
